---
name: subagent-creator
description: サブエージェント定義ファイルを生成する作業系スキル
allowed-tools: Read, Write, Edit
---
# Subagent Creator

## 概要

ユーザーから提供された要件に基づき、プラグイン構築ルールに準拠したサブエージェント定義ファイル（Markdown形式）を生成します。テンプレートの適用、命名規約の検証、必須項目の確認を行い、構造的に正しい定義ファイルを作成します。

## 処理内容

1. **plugin-construction-guidelinesの参照**
   - プラグイン構築の全体設計原則を確認
   - サブエージェントの責任分離原則を理解
   - 命名規約（`<ドメイン名>-agent`形式）を確認

2. **ユーザーとの対話による要件収集**

   **初期ヒアリング:**

   ```markdown
   どのようなサブエージェントを作成したいですか？
   作成したいサブエージェントの目的や、解決したい課題について教えてください。
   
   例:
   - セキュリティチェックを担当するエージェント
   - ドキュメント生成を自動化するエージェント
   - テストコード作成を支援するエージェント
   ```

   ユーザーの回答に基づき、以下の情報を分析：
   - 対象ドメイン領域
   - 主な責任範囲
   - 必要となるツールセット
   - 関連する制約事項

3. **実装計画の作成**

   収集した情報を基に、以下の実装計画を作成：

   **A. エージェント名の提案**
   - 命名規約（`<ドメイン名>-agent`）に基づいて3つの候補を提案
   - 各候補の選定理由を説明

   **B. Role（役割）の提案**
   - 1〜2文で簡潔な役割説明を作成
   - ユーザーの要件を反映

   **C. 責任範囲の提案**

   **責任範囲内:**
   - 担当すべき業務をリストアップ
   - 各項目を「**業務名**: 説明」形式で記述
   - ドメイン領域に適した具体的な責任を定義

   **責任範囲外:**
   - 担当しない業務を項目リストアップ
   - 境界を明確にするため、混同されやすい業務を指定
   - 他のエージェントが担当すべき領域を明示

   **D. 使用ツールの提案**
   - 責任範囲に基づいて必要なツールを選定
   - 以下から適切なセットを提案：
     - 基本セット: Read, Write, Edit, Bash
     - 開発セット: Read, Write, Edit, MultiEdit, Grep, Glob, Bash
     - 完全セット: Read, Write, Edit, MultiEdit, Grep, Glob, LS, Bash, Task, Agent, NotebookEdit, WebFetch, WebSearch

   **E. 表示色の提案**
   - エージェントの性質に応じた色を提案
     - セキュリティ系: Red
     - 開発・ビルド系: Blue
     - 分析系: Purple
     - ドキュメント系: Green
     - テスト系: Yellow

   **F. 注意事項の提案**
   - 運用上重要な制約事項を3〜5項目提案
   - 責任範囲に関連する注意点を明記

4. **実装計画の提示と承認**

   作成した実装計画を要約して提示：

   ```markdown
   === サブエージェント実装計画 ===
   
   【エージェント名】
   [候補1]、[候補2]、[候補3]
   → 推奨: [候補1] - [簡潔な理由]
   
   【Role】
   [提案する役割説明（1〜2文）]
   
   【主な責任】
   責任範囲: [i]件
   - [項目1]
   - [項目2]
   - [項目3] 
   
   責任範囲外: [j]件
   - [項目1]
   - [項目2]
   
   【ツール・設定】
   ツール: [提案するツールセット名]
   色: [提案する色]
   
   【注意事項（[k]件）】
   - [項目1]
   - [項目2]
   - [項目3] 
   
   ===========================
   
   この内容で作成してよろしいですか？
   
   A. 承認（作成を開始）
   B. 詳細確認（全項目を表示）
   C. 修正（変更したい項目を指定）
   ```

   - 選択肢Aの場合: そのまま作成に進む
   - 選択肢Bの場合: 全項目を詳細表示してから承認を取る
   - 選択肢Cの場合: 修正したい項目を聞いて更新

5. **修正対応（必要な場合）**
   - ユーザーの修正指示に基づいて計画を更新
   - 修正後の計画を再提示
   - 承認されるまで繰り返し

6. **テンプレートの適用**
   - 承認された実装計画をテンプレートに適用
   - フロントマター（name, description, tools, model, color）を生成
   - 各セクションを構造化して記述

7. **構造検証**
   - 必須セクションがすべて含まれているか確認
   - Markdown形式が正しいか検証
   - スキル名やコマンド名が記述されていないか確認（禁止事項）
   - 環境依存情報が含まれていないか確認（禁止事項）

8. **定義ファイルの生成**
   - 検証に合格した定義を指定された出力先パスに保存
   - UTF-8エンコーディングで保存
   - 生成結果をユーザーに報告

## 出力

- 生成されたサブエージェント定義ファイルのパス
- 生成したエージェント名
- 生成したサブエージェントの概要

## 注意事項

- サブエージェント定義には**スキル名を記述しない**（責任範囲のみを定義）
- サブエージェント定義には**環境依存情報を含めない**（ファイルパス、URL等）
- model フィールドは必ず `inherit` に固定
- tools フィールドはカンマ区切りで記述（例: `Read, Write, Edit, Bash`）
- 責任範囲内と責任範囲外は明確に区別して記述
- Role は1〜2文で簡潔に、責任範囲の要約として機能させる
