---
name: plugin-construction-guidelines
description: Claude Code プラグインマーケットプレイス構築における設計原則、命名規約、ドキュメント記述ルールを提供します。サブエージェント、エージェントスキル、コマンドを作成・編集する場合に使用します。
---
# Plugin Construction Guidelines

## 概要

Claude Code プラグインの要素（サブエージェント、エージェントスキル、コマンド）を構築する際の全体的な設計原則、責任分離の考え方、依存関係のルールを定義します。本ガイドラインは構築における基本方針を示すものであり、各要素の具体的な記述方法は個別スキルを使用してください。

## 適用範囲

以下のプラグイン要素の設計・構築時に適用：

- サブエージェント
- 規約系スキル
- 作業系スキル
- コマンド

## 1. 全体構成の原則

プラグインは**3要素**で構成され、それぞれが明確な責任を持ちます。

**3要素の責任分離:**

- **サブエージェント:** 責任範囲の定義のみ（「何をすべきか」を明示）
  - ドメイン上の責任境界を明示する役割
  - 環境依存情報を含まない
  - エージェントスキル・コマンドへの依存を持たない
  
- **エージェントスキル:** 規約提供または処理ロジックのみ
  - 再利用可能な単位として設計
  - 環境依存情報を含まない
  - サブエージェント・コマンドへの依存を持たない
  
- **コマンド:** 責任×処理×環境の組み合わせを一元管理
  - サブエージェントとスキルをバインド
  - プロジェクト固有情報をすべて保持
  - 実行フローを定義

**責任分離の効果:**

- 環境変更時はコマンドのみ修正
- スキルとサブエージェントの再利用性が向上
- 依存関係が明確で追跡が容易

**依存関係の方向:**

- サブエージェントとスキルは独立（依存関係を持たない）
- コマンドのみが両者の関係を定義

**環境依存情報の配置:**

- ファイルパス、リポジトリURL、環境変数は**コマンドのみ**に記述
- サブエージェントとスキルには**一切含めない**

## 2. エージェントスキルの分類基準

**規約系スキル（Convention Skills）:**

- 静的な知識を提供（コーディング規約、ガイドラインなど）
- 参照専用、実行を伴わない
- エラーハンドリング不要

**作業系スキル（Operational Skills）:**

- 動的な処理を実行（コード生成、ドキュメント作成・編集、分析、変換など）
- 入出力が明確に定義される
- エラーハンドリング必須
- `allow-tools` は必要に応じて指定

## 3. 粒度の原則

**サブエージェント:**

- 単一のドメイン領域を担当
- 責任範囲が明確に境界付けられている

**規約系スキル:**

- 単一のドメイン（言語、技術、フレームワーク）を対象
- スキル単独で規約として機能

**作業系スキル:**

- 単一責任原則に従う（1つの明確な目的）
- 入出力が明確に定義可能
- 他のスキルと組み合わせ可能
- 実行時間の目安：数秒〜数分程度

**コマンド:**

- 複数スキルを組み合わせた完結したワークフロー
- ユーザーが理解しやすい操作単位

**粒度の判断基準:**

- 大きすぎる：再利用性が低下、変更時の影響範囲が広い
- 小さすぎる：管理コストが増加、全体像が把握しにくい

### 4. 再利用性の確保

**設計の基本方針:**

- エージェントスキルは常に再利用前提で設計
- 環境依存を排除し、異なるプロジェクト間で利用可能に
- コマンドが環境差異を吸収

**再利用を促進する設計:**

- スキルは汎用的な処理単位として定義
- 入出力インターフェースを明確に
- プロジェクト固有の仮定を排除
